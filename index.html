<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Thailand Countdown Ultimate</title>

<link rel="manifest" href="manifest.json">

<style>
body{
    font-family:sans-serif;
    text-align:center;
    margin:0;
    padding:20px;
    background:linear-gradient(to right,#0d47a1,#42a5f5);
    color:white;
}
.card{
    background:white;
    color:#333;
    padding:20px;
    border-radius:20px;
    max-width:500px;
    margin:auto;
}
.progress{
    width:100%;
    background:#ddd;
    border-radius:10px;
}
.bar{
    height:15px;
    background:#4caf50;
    width:0%;
}
.celebrate{
    font-size:40px;
    display:none;
    animation:pop 1s infinite alternate;
}
@keyframes pop{
    from{transform:scale(1);}
    to{transform:scale(1.2);}
}
</style>
</head>
<body>

<div class="card">
<h2>ğŸ‡¹ğŸ‡­ Countdown Ultimate V6</h2>

à¸§à¸±à¸™à¸šà¸´à¸™à¸à¸¥à¸±à¸š:
<input type="datetime-local" id="end">
<button onclick="saveDate()">à¸šà¸±à¸™à¸—à¸¶à¸</button>

<h3 id="countdown"></h3>

<div class="progress"><div class="bar" id="bar"></div></div>
<div id="percent"></div>

<hr>
<h3>ğŸŒ à¹€à¸§à¸¥à¸²à¹‚à¸¥à¸</h3>
<div id="world"></div>

<hr>
<h3>ğŸ›« à¸ªà¸™à¸²à¸¡à¸šà¸´à¸™</h3>
<div>
BKK - Suvarnabhumi<br>
ADD - Addis Ababa
</div>

<hr>
<h3>ğŸŒ¤ à¸­à¸²à¸à¸²à¸¨à¸§à¸±à¸™à¹€à¸”à¸´à¸™à¸—à¸²à¸‡</h3>
<div id="weather">à¸à¸³à¸¥à¸±à¸‡à¹‚à¸«à¸¥à¸”à¸ªà¸ à¸²à¸à¸­à¸²à¸à¸²à¸¨...</div>
    
<div class="celebrate" id="celebrate">ğŸ‰ğŸ‡¹ğŸ‡­âœˆï¸</div>

</div>

<script>
if('serviceWorker' in navigator){
    navigator.serviceWorker.register('sw.js');
}

let endDate=new Date(localStorage.getItem("end")||"2026-04-23T12:00");
document.getElementById("end").value=endDate.toISOString().slice(0,16);

function saveDate(){
    endDate=new Date(document.getElementById("end").value);
    localStorage.setItem("end",endDate);
}

function update(){
    let now=new Date();
    let remain=endDate-now;

    if(remain<=0){
        document.getElementById("countdown").innerHTML="ğŸ‰ à¸–à¸¶à¸‡à¸§à¸±à¸™à¸à¸¥à¸±à¸šà¹„à¸—à¸¢à¹à¸¥à¹‰à¸§!";
        document.getElementById("celebrate").style.display="block";
        return;
    }

    let d=Math.floor(remain/86400000);
    let h=Math.floor((remain%86400000)/3600000);
    let m=Math.floor((remain%3600000)/60000);
    let s=Math.floor((remain%60000)/1000);

    document.getElementById("countdown").innerHTML=
    `à¹€à¸«à¸¥à¸·à¸­ ${d} à¸§à¸±à¸™ ${h} à¸Šà¸¡ ${m} à¸™à¸²à¸—à¸µ ${s} à¸§à¸´`;

    let percent=100-((remain/(1000*60*60*24*100))*100);
    document.getElementById("bar").style.width=percent+"%";
    document.getElementById("percent").innerHTML="à¸„à¸§à¸²à¸¡à¸„à¸·à¸šà¸«à¸™à¹‰à¸² "+percent.toFixed(1)+"%";

    let thai=new Date().toLocaleString("th-TH",{timeZone:"Asia/Bangkok"});
    let eth=new Date().toLocaleString("en-GB",{timeZone:"Africa/Addis_Ababa"});
    document.getElementById("world").innerHTML=
    `ğŸ‡¹ğŸ‡­ à¹„à¸—à¸¢: ${thai}<br>ğŸ‡ªğŸ‡¹ à¹€à¸­à¸˜à¸´à¹‚à¸­à¹€à¸›à¸µà¸¢: ${eth}`;
}

setInterval(update,1000);
update();
    // =================== WEATHER ===================
const apiKey = "YOUR_API_KEY"; // à¹ƒà¸ªà¹ˆ API Key à¸‚à¸­à¸‡ OpenWeather
const city = "Bangkok,TH";     // à¹€à¸¡à¸·à¸­à¸‡à¸›à¸¥à¸²à¸¢à¸—à¸²à¸‡

function fetchWeather() {
    fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&units=metric`)
    .then(res => res.json())
    .then(data => {
        // à¸«à¸² forecast à¸—à¸µà¹ˆà¸•à¸£à¸‡à¸à¸±à¸šà¸§à¸±à¸™à¸šà¸´à¸™
        let targetDate = endDate.toISOString().split("T")[0]; // YYYY-MM-DD
        let forecast = data.list.find(f => f.dt_txt.startsWith(targetDate));
        if(forecast){
            let temp = forecast.main.temp.toFixed(1);
            let desc = forecast.weather[0].description;
            document.getElementById("weather").innerHTML = `ğŸŒ¡ ${temp}Â°C, ${desc}`;
        } else {
            document.getElementById("weather").innerHTML = "à¹„à¸¡à¹ˆà¸à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸¢à¸²à¸à¸£à¸“à¹Œà¸§à¸±à¸™à¸™à¸±à¹‰à¸™";
        }
    })
    .catch(err=>{
        console.log(err);
        document.getElementById("weather").innerHTML = "à¹‚à¸«à¸¥à¸”à¸ªà¸ à¸²à¸à¸­à¸²à¸à¸²à¸¨à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ";
    });
}

// à¹€à¸£à¸µà¸¢à¸à¸•à¸­à¸™à¹€à¸£à¸´à¹ˆà¸¡à¹€à¸§à¹‡à¸šà¹à¸¥à¸°à¸—à¸¸à¸ 10 à¸™à¸²à¸—à¸µ
fetchWeather();
setInterval(fetchWeather, 10*60*1000);
</script>

</body>
</html>
